<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DopeMAN - Skills Control Center (Real Data)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            position: relative;
        }

        .header h1 {
            font-size: 2.5em;
            font-weight: 700;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .rescan-btn {
            position: absolute;
            top: 0;
            right: 0;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid rgba(255, 255, 255, 0.5);
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .rescan-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            border-color: rgba(255, 255, 255, 0.8);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .rescan-btn:active {
            transform: translateY(0);
        }

        .rescan-btn.loading .rescan-icon {
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        .rescan-icon {
            font-size: 1.2em;
            display: inline-block;
        }

        .dashboard {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 24px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            transition: transform 0.2s, box-shadow 0.2s;
            cursor: pointer;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 48px rgba(0,0,0,0.15);
        }

        .card-header {
            display: flex;
            align-items: center;
            margin-bottom: 16px;
        }

        .card-icon {
            font-size: 2em;
            margin-right: 12px;
        }

        .card-title {
            font-size: 1.3em;
            font-weight: 600;
            color: #333;
        }

        .card-count {
            font-size: 2.5em;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 8px;
        }

        .card-label {
            font-size: 0.9em;
            color: #666;
        }

        .main-panel {
            background: white;
            border-radius: 16px;
            padding: 32px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
            margin-bottom: 30px;
        }

        .panel-title {
            font-size: 1.5em;
            font-weight: 600;
            margin-bottom: 20px;
            color: #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .search-box {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .search-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.2s;
        }

        .search-input:focus {
            outline: none;
            border-color: #667eea;
        }

        .filter-buttons {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }

        .filter-btn {
            padding: 8px 16px;
            border: 2px solid #667eea;
            background: white;
            color: #667eea;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.9em;
        }

        .filter-btn.active {
            background: #667eea;
            color: white;
        }

        .filter-btn:hover {
            background: #667eea;
            color: white;
        }

        .tree-view {
            font-family: 'Monaco', 'Courier New', monospace;
            font-size: 0.9em;
            line-height: 1.6;
        }

        .tree-item {
            padding: 6px 12px;
            margin: 2px 0;
            border-radius: 6px;
            transition: background 0.2s;
        }

        .tree-item:hover {
            background: #f5f5f5;
        }

        .tree-node {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tree-indent {
            margin-left: 24px;
        }

        .status-dot {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
        }

        .status-team { background: #10b981; }
        .status-single { background: #3b82f6; }
        .status-coordinator { background: #f59e0b; }
        .status-worker { background: #8b5cf6; }

        .badge {
            display: inline-block;
            padding: 2px 8px;
            background: #667eea;
            color: white;
            border-radius: 12px;
            font-size: 0.75em;
            font-weight: 600;
        }

        .badge.team { background: #10b981; }
        .badge.single { background: #3b82f6; }
        .badge.coordinator { background: #f59e0b; }
        .badge.worker { background: #8b5cf6; }

        .tab-container {
            display: flex;
            gap: 8px;
            margin-bottom: 20px;
            border-bottom: 2px solid #e0e0e0;
        }

        .tab {
            padding: 12px 24px;
            cursor: pointer;
            border-bottom: 3px solid transparent;
            transition: all 0.2s;
            font-weight: 500;
        }

        .tab:hover {
            background: #f5f5f5;
        }

        .tab.active {
            border-bottom-color: #667eea;
            color: #667eea;
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        .stats-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 16px;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2em;
            font-weight: 700;
            color: #667eea;
        }

        .stat-label {
            font-size: 0.85em;
            color: #666;
            margin-top: 4px;
        }

        .footer {
            text-align: center;
            color: white;
            margin-top: 30px;
            opacity: 0.8;
        }

        .expandable {
            cursor: pointer;
        }

        .expandable::before {
            content: '‚ñ∂ ';
            display: inline-block;
            transition: transform 0.2s;
        }

        .expandable.expanded::before {
            transform: rotate(90deg);
        }

        .collapsed {
            display: none;
        }

        .tree-children {
            display: block;
            transition: all 0.2s ease-in-out;
        }

        /* Dev Projects Styles */
        .project-card {
            background: white;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            padding: 16px;
            margin: 8px 0;
            transition: all 0.2s;
        }

        .project-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            border-color: #667eea;
        }

        .project-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
        }

        .project-name {
            font-size: 1.1em;
            font-weight: 600;
            color: #333;
        }

        .project-type-badge {
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.85em;
            font-weight: 600;
        }

        .project-type-work {
            background: #3b82f6;
            color: white;
        }

        .project-type-own-dev {
            background: #10b981;
            color: white;
        }

        .project-type-github-ref {
            background: #8b5cf6;
            color: white;
        }

        .project-type-other {
            background: #6b7280;
            color: white;
        }

        .project-meta {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
            margin-bottom: 8px;
            font-size: 0.9em;
            color: #666;
        }

        .project-meta-item {
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .tech-stack {
            display: flex;
            gap: 6px;
            flex-wrap: wrap;
            margin-bottom: 8px;
        }

        .tech-badge {
            padding: 2px 8px;
            background: #f3f4f6;
            border: 1px solid #d1d5db;
            border-radius: 4px;
            font-size: 0.8em;
            color: #4b5563;
        }

        .project-actions {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .action-btn {
            padding: 6px 12px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.85em;
            transition: background 0.2s;
            text-decoration: none;
        }

        .action-btn:hover {
            background: #5568d3;
        }

        .action-btn-secondary {
            background: white;
            color: #667eea;
            border: 1px solid #667eea;
        }

        .action-btn-secondary:hover {
            background: #f5f5f5;
        }

        /* Ë®≠ÂÆöÈ†ÅÈù¢Ê®£Âºè */
        .settings-section {
            background: white;
            padding: 0;
        }

        .settings-section h3 {
            color: #333;
            font-size: 1.2em;
            margin-bottom: 8px;
        }

        .editor-tool-option {
            display: flex;
            align-items: center;
            padding: 12px 16px;
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .editor-tool-option:hover {
            background: #e8e9ea;
            border-color: #667eea;
        }

        .editor-tool-option.selected {
            background: #e8eaf6;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
        }

        .editor-tool-option input[type="radio"] {
            margin-right: 12px;
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .editor-tool-icon {
            font-size: 24px;
            margin-right: 12px;
        }

        .editor-tool-info {
            flex: 1;
        }

        .editor-tool-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 2px;
        }

        .editor-tool-protocol {
            font-size: 0.85em;
            color: #666;
            font-family: 'Monaco', 'Courier New', monospace;
        }

        .editor-tool-toggle {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9em;
            color: #666;
        }

        .toggle-switch {
            position: relative;
            width: 44px;
            height: 24px;
            background: #ccc;
            border-radius: 12px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .toggle-switch.enabled {
            background: #10b981;
        }

        .toggle-switch::after {
            content: '';
            position: absolute;
            top: 2px;
            left: 2px;
            width: 20px;
            height: 20px;
            background: white;
            border-radius: 50%;
            transition: left 0.2s;
        }

        .toggle-switch.enabled::after {
            left: 22px;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéõÔ∏è Skills Control Center</h1>
            <p>ÁúüÂØ¶Ë≥áÊñôË¶ñË¶∫Âåñ - ÂÆåÊï¥Áí∞Â¢ÉÊéÉÊèèÁµêÊûú</p>
            <button id="rescanBtn" class="rescan-btn">
                <span class="rescan-icon">üîÑ</span>
                <span class="rescan-text">ÈáçÊñ∞ Scan</span>
            </button>
        </div>

        <!-- Áµ±Ë®àÂÑÄË°®Êùø -->
        <div class="dashboard" id="dashboard">
            <!-- ÂãïÊÖãÁîüÊàê -->
        </div>

        <!-- ‰∏ªÈù¢Êùø -->
        <div class="main-panel">
            <div class="panel-title">
                <span>üìä Ë©≥Á¥∞Ë≥áË®ä</span>
                <span style="font-size: 0.6em; font-weight: normal; color: #999;">
                    ÊúÄÂæåÊéÉÊèè: <span id="lastScan"></span>
                </span>
            </div>

            <!-- ÊêúÂ∞ãÊ°Ü -->
            <div class="search-box">
                <input type="text" class="search-input" id="searchInput" placeholder="ÊêúÂ∞ã Skills, Agents, Rules, Commands...">
            </div>

            <!-- ÈÅéÊøæÊåâÈàï -->
            <div class="filter-buttons" id="filterButtons">
                <!-- ÂãïÊÖãÁîüÊàê -->
            </div>

            <!-- Ê®ôÁ±§È†Å -->
            <div class="tab-container">
                <div class="tab active" data-tab="skills">Skills</div>
                <div class="tab" data-tab="agents">Agents</div>
                <div class="tab" data-tab="rules">Rules</div>
                <div class="tab" data-tab="commands">Commands</div>
                <div class="tab" data-tab="dev-projects">Dev Projects</div>
                <div class="tab" data-tab="layers">ÂàÜÂ±§Ë¶ñÂúñ</div>
                <div class="tab" data-tab="settings">‚öôÔ∏è Ë®≠ÂÆö</div>
            </div>

            <!-- Ê®ôÁ±§È†ÅÂÖßÂÆπ -->
            <div id="skills" class="tab-content active">
                <div class="tree-view" id="skillsTree"></div>
            </div>

            <div id="agents" class="tab-content">
                <div class="tree-view" id="agentsTree"></div>
            </div>

            <div id="rules" class="tab-content">
                <div class="tree-view" id="rulesTree"></div>
            </div>

            <div id="commands" class="tab-content">
                <div class="tree-view" id="commandsTree"></div>
            </div>

            <div id="dev-projects" class="tab-content">
                <div class="tree-view" id="devProjectsTree"></div>
            </div>

            <div id="layers" class="tab-content">
                <div class="tree-view" id="layersTree"></div>
            </div>

            <div id="settings" class="tab-content">
                <div style="padding: 20px; max-width: 800px;">
                    <h2 style="margin-top: 0; color: #667eea;">‚öôÔ∏è Áî®Êà∂Ë®≠ÂÆö</h2>

                    <div class="settings-section">
                        <h3>È†êË®≠Á∑®ËºØÂô®</h3>
                        <p style="color: #666; margin-bottom: 15px;">ÈÅ∏ÊìáÈªûÊìä„ÄåOpen„ÄçÊåâÈàïÊôÇ‰ΩøÁî®ÁöÑÂ∑•ÂÖ∑</p>

                        <div id="editorToolsContainer" style="display: flex; flex-direction: column; gap: 12px;">
                            <!-- ÂãïÊÖãÁîüÊàêÁ∑®ËºØÂô®ÈÅ∏È†Ö -->
                        </div>

                        <button onclick="saveSettings()" style="margin-top: 20px; padding: 10px 20px; background: #667eea; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 14px;">
                            üíæ ÂÑ≤Â≠òË®≠ÂÆö
                        </button>
                        <span id="saveStatus" style="margin-left: 15px; color: #10b981; display: none;">‚úì Â∑≤ÂÑ≤Â≠ò</span>
                    </div>

                    <div class="settings-section" style="margin-top: 40px; padding-top: 30px; border-top: 1px solid #e0e0e0;">
                        <h3>Êñ∞Â¢ûËá™Ë®ÇÂ∑•ÂÖ∑</h3>
                        <p style="color: #666; margin-bottom: 15px;">Êì¥ÂÖÖÂ∑•ÂÖ∑Â∫´ÔºåÂä†ÂÖ•ÊÇ®Â∏∏Áî®ÁöÑÁ∑®ËºØÂô®ÊàñÈñãÁôºÂ∑•ÂÖ∑</p>

                        <div style="display: grid; grid-template-columns: 1fr 2fr 2fr 1fr; gap: 10px; margin-bottom: 15px;">
                            <input type="text" id="newToolIcon" placeholder="üéØ" maxlength="2" style="padding: 8px; border: 1px solid #ddd; border-radius: 4px; text-align: center; font-size: 20px;">
                            <input type="text" id="newToolName" placeholder="Â∑•ÂÖ∑ÂêçÁ®±" style="padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                            <input type="text" id="newToolProtocol" placeholder="protocol://file" style="padding: 8px; border: 1px solid #ddd; border-radius: 4px;">
                            <button onclick="addCustomTool()" style="padding: 8px 15px; background: #10b981; color: white; border: none; border-radius: 4px; cursor: pointer;">
                                ‚ûï Êñ∞Â¢û
                            </button>
                        </div>

                        <div style="background: #f8f9fa; padding: 12px; border-radius: 6px; font-size: 13px; color: #666;">
                            <strong>ÁØÑ‰æãÔºö</strong><br>
                            ‚Ä¢ WebStorm: <code>webstorm://open?file=</code><br>
                            ‚Ä¢ IntelliJ IDEA: <code>idea://open?file=</code><br>
                            ‚Ä¢ Sublime Text: <code>subl://open?file=</code>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            <p>DopeMAN v1.0.0 | Skills Control Center</p>
            <p style="font-size: 0.9em; margin-top: 8px;">Êô∫ËÉΩÁí∞Â¢ÉÁÆ°ÁêÜÁßòÊõ∏ÂúòÈöä</p>
        </div>
    </div>

    <script>
        let data = null;
        let filteredData = null;

        // ËºâÂÖ•Ë≥áÊñô
        async function loadData() {
            try {
                const response = await fetch('./control-center-real-data.json');
                data = await response.json();
                filteredData = data;
                renderAll();
            } catch (error) {
                console.error('ËºâÂÖ•Ë≥áÊñôÂ§±Êïó:', error);
            }
        }

        // Ê∏≤ÊüìÊâÄÊúâÂÖßÂÆπ
        function renderAll() {
            renderDashboard();
            renderSkillsTree();
            renderAgentsTree();
            renderRulesTree();
            renderCommandsTree();
            renderDevProjectsTree();
            renderLayersTree();
            renderSettings();
            renderFilters();

            // Êõ¥Êñ∞ÊúÄÂæåÊéÉÊèèÊôÇÈñì
            const lastScan = new Date(data.last_scan);
            document.getElementById('lastScan').textContent = lastScan.toLocaleString('zh-TW');
        }

        // Ê∏≤ÊüìÂÑÄË°®Êùø
        function renderDashboard() {
            const dashboard = document.getElementById('dashboard');
            const cards = [
                {
                    icon: 'üåç',
                    title: 'ÂÖ®Âüü Skills',
                    count: data.categories.global_skills.count,
                    label: 'Â∑≤ÂÆâË£ùÁöÑÂÖ®ÂüüÊäÄËÉΩ',
                    tab: 'skills'
                },
                {
                    icon: 'üìÅ',
                    title: 'Â∞àÊ°à Skills',
                    count: data.categories.project_skills.count,
                    label: 'Â∞àÊ°àÁâπÂÆöÊäÄËÉΩ',
                    tab: 'skills'
                },
                {
                    icon: 'üî®',
                    title: 'ÈñãÁôº‰∏≠ Skills',
                    count: data.categories.dev_skills.count,
                    label: 'Êúâ Git Repo ÁöÑÊäÄËÉΩ',
                    tab: 'skills'
                },
                {
                    icon: 'üìã',
                    title: 'ÂÖ®Âüü Rules',
                    count: data.categories.global_rules.count,
                    label: 'ÂÖ®ÂüüË¶èÂâá',
                    tab: 'rules'
                },
                {
                    icon: 'üìÇ',
                    title: 'Â∞àÊ°à Rules',
                    count: data.categories.project_rules.count,
                    label: 'Â∞àÊ°àË¶èÂâá',
                    tab: 'rules'
                },
                {
                    icon: 'ü§ñ',
                    title: 'Agents',
                    count: data.categories.agents.count,
                    label: 'Coordinators & Workers',
                    tab: 'agents'
                },
                {
                    icon: '‚å®Ô∏è',
                    title: 'Commands',
                    count: data.categories.commands.count,
                    label: 'ÂèØÁî®Êåá‰ª§',
                    tab: 'commands'
                },
                {
                    icon: 'üíª',
                    title: 'Dev Projects',
                    count: data.categories.dev_projects.count,
                    label: 'ÈñãÁôºÂ∞àÊ°à',
                    tab: 'dev-projects'
                }
            ];

            dashboard.innerHTML = cards.map(card => `
                <div class="card" data-tab="${card.tab}" onclick="switchToTab('${card.tab}')">
                    <div class="card-header">
                        <div class="card-icon">${card.icon}</div>
                        <div class="card-title">${card.title}</div>
                    </div>
                    <div class="card-count">${card.count}</div>
                    <div class="card-label">${card.label}</div>
                </div>
            `).join('');
        }

        // Ê∏≤Êüì Skills Ê®πÁãÄÂúñ
        function renderSkillsTree() {
            const tree = document.getElementById('skillsTree');
            const globalSkills = data.categories.global_skills.items;
            const projectSkills = data.categories.project_skills.items;
            const devSkills = data.categories.dev_skills.items;

            let html = '';

            // ÂÖ®Âüü Skills
            html += `
                <div class="tree-item">
                    <div class="tree-node expandable expanded" onclick="toggleExpand(this)">
                        <span>üåç ÂÖ®Âüü Skills</span>
                        <span class="badge">${globalSkills.length}</span>
                    </div>
                </div>
                <div class="tree-children">
            `;

            globalSkills.slice(0, 20).forEach(skill => {
                const type = skill.type === 'team' ? 'team' : 'single';
                html += `
                    <div class="tree-item tree-indent">
                        <div class="tree-node">
                            <span class="status-dot status-${type}"></span>
                            <span>${skill.name}</span>
                            <span class="badge ${type}">${skill.type}</span>
                        </div>
                    </div>
                `;
            });

            if (globalSkills.length > 20) {
                html += `
                    <div class="tree-item tree-indent">
                        <div class="tree-node" style="color: #999;">
                            ... ÈÇÑÊúâ ${globalSkills.length - 20} ÂÄã
                        </div>
                    </div>
                `;
            }

            html += `</div>`;

            // Â∞àÊ°à Skills
            html += `
                <div class="tree-item" style="margin-top: 20px;">
                    <div class="tree-node expandable expanded" onclick="toggleExpand(this)">
                        <span>üìÅ Â∞àÊ°à Skills</span>
                        <span class="badge">${projectSkills.length}</span>
                    </div>
                </div>
                <div class="tree-children">
            `;

            const projectGroups = {};
            projectSkills.forEach(skill => {
                if (!projectGroups[skill.project_path]) {
                    projectGroups[skill.project_path] = [];
                }
                projectGroups[skill.project_path].push(skill);
            });

            Object.entries(projectGroups).slice(0, 5).forEach(([project, skills]) => {
                html += `
                    <div class="tree-item tree-indent">
                        <div class="tree-node expandable" onclick="toggleExpand(this)">
                            <span>üìÇ ${project}</span>
                            <span class="badge">${skills.length}</span>
                        </div>
                    </div>
                    <div class="tree-children" style="display: none;">
                `;

                skills.forEach(skill => {
                    html += `
                        <div class="tree-item" style="margin-left: 48px;">
                            <div class="tree-node">
                                <span class="status-dot status-single"></span>
                                <span>${skill.skill_name}</span>
                                ${skill.is_duplicate ? '<span class="badge" style="background: #ef4444;">ÈáçË§á</span>' : ''}
                            </div>
                        </div>
                    `;
                });

                html += `</div>`;
            });

            html += `</div>`;

            // ÈñãÁôº‰∏≠ Skills
            if (devSkills.length > 0) {
                html += `
                    <div class="tree-item" style="margin-top: 20px;">
                        <div class="tree-node expandable expanded" onclick="toggleExpand(this)">
                            <span>üî® ÈñãÁôº‰∏≠ Skills</span>
                            <span class="badge">${devSkills.length}</span>
                        </div>
                    </div>
                    <div class="tree-children">
                `;

                devSkills.forEach(skill => {
                    html += `
                        <div class="tree-item tree-indent">
                            <div class="tree-node">
                                <span class="status-dot status-team"></span>
                                <span>${skill.name}</span>
                                ${skill.dirty ? '<span class="badge" style="background: #f59e0b;">Êú™Êèê‰∫§</span>' : ''}
                            </div>
                        </div>
                    `;
                });

                html += `</div>`;
            }

            tree.innerHTML = html;
        }

        // Ê∏≤Êüì Agents Ê®πÁãÄÂúñ
        function renderAgentsTree() {
            const tree = document.getElementById('agentsTree');
            const agents = data.categories.agents.items;

            const coordinators = agents.filter(a => a.type === 'coordinator');
            const workers = agents.filter(a => a.type === 'worker');

            let html = '';

            // Coordinators
            html += `
                <div class="tree-item">
                    <div class="tree-node expandable expanded" onclick="toggleExpand(this)">
                        <span>üéØ Coordinators</span>
                        <span class="badge coordinator">${coordinators.length}</span>
                    </div>
                </div>
                <div class="tree-children">
            `;

            coordinators.forEach(coord => {
                html += `
                    <div class="tree-item tree-indent">
                        <div class="tree-node">
                            <span class="status-dot status-coordinator"></span>
                            <span>${coord.name}</span>
                            <span style="color: #999; font-size: 0.85em; margin-left: 8px;">
                                ‚Üí ${coord.belongs_to_project}
                            </span>
                        </div>
                    </div>
                `;
            });

            html += `</div>`;

            // Workers
            html += `
                <div class="tree-item" style="margin-top: 20px;">
                    <div class="tree-node expandable expanded" onclick="toggleExpand(this)">
                        <span>üë∑ Workers</span>
                        <span class="badge worker">${workers.length}</span>
                    </div>
                </div>
                <div class="tree-children">
            `;

            const workerGroups = {};
            workers.forEach(worker => {
                if (!workerGroups[worker.group]) {
                    workerGroups[worker.group] = [];
                }
                workerGroups[worker.group].push(worker);
            });

            Object.entries(workerGroups).forEach(([group, groupWorkers]) => {
                html += `
                    <div class="tree-item tree-indent">
                        <div class="tree-node expandable" onclick="toggleExpand(this)">
                            <span>üìÅ ${group}</span>
                            <span class="badge">${groupWorkers.length}</span>
                        </div>
                    </div>
                    <div class="tree-children" style="display: none;">
                `;

                groupWorkers.forEach(worker => {
                    html += `
                        <div class="tree-item" style="margin-left: 48px;">
                            <div class="tree-node">
                                <span class="status-dot status-worker"></span>
                                <span>${worker.name}</span>
                            </div>
                        </div>
                    `;
                });

                html += `</div>`;
            });

            html += `</div>`;

            tree.innerHTML = html;
        }

        // Ê∏≤Êüì Rules Ê®πÁãÄÂúñ
        function renderRulesTree() {
            const tree = document.getElementById('rulesTree');
            const globalRules = data.categories.global_rules.items;
            const projectRules = data.categories.project_rules.items;

            let html = '';

            // ÂÖ®Âüü Rules
            html += `
                <div class="tree-item">
                    <div class="tree-node expandable expanded" onclick="toggleExpand(this)">
                        <span>üåç ÂÖ®Âüü Rules</span>
                        <span class="badge">${globalRules.length}</span>
                    </div>
                </div>
                <div class="tree-children">
            `;

            globalRules.forEach(rule => {
                html += `
                    <div class="tree-item tree-indent">
                        <div class="tree-node">
                            <span>üìã ${rule.name}</span>
                            ${rule.applicability.length > 0 ?
                                `<span style="color: #999; font-size: 0.85em; margin-left: 8px;">
                                    ‚Üí ${rule.applicability.join(', ')}
                                </span>` : ''}
                        </div>
                    </div>
                `;
            });

            html += `</div>`;

            // Â∞àÊ°à Rules
            html += `
                <div class="tree-item" style="margin-top: 20px;">
                    <div class="tree-node expandable expanded" onclick="toggleExpand(this)">
                        <span>üìÅ Â∞àÊ°à Rules</span>
                        <span class="badge">${projectRules.length}</span>
                    </div>
                </div>
                <div class="tree-children">
            `;

            const ruleGroups = {};
            projectRules.forEach(rule => {
                if (!ruleGroups[rule.project_path]) {
                    ruleGroups[rule.project_path] = [];
                }
                ruleGroups[rule.project_path].push(rule);
            });

            Object.entries(ruleGroups).forEach(([project, rules]) => {
                html += `
                    <div class="tree-item tree-indent">
                        <div class="tree-node expandable" onclick="toggleExpand(this)">
                            <span>üìÇ ${project}</span>
                            <span class="badge">${rules.length}</span>
                        </div>
                    </div>
                    <div class="tree-children" style="display: none;">
                `;

                rules.forEach(rule => {
                    html += `
                        <div class="tree-item" style="margin-left: 48px;">
                            <div class="tree-node">
                                <span>üìã ${rule.name}</span>
                            </div>
                        </div>
                    `;
                });

                html += `</div>`;
            });

            html += `</div>`;

            tree.innerHTML = html;
        }

        // Ê∏≤Êüì Commands Ê®πÁãÄÂúñ
        function renderCommandsTree() {
            const tree = document.getElementById('commandsTree');
            const commands = data.categories.commands.items;

            // ÂèñÂæóÊâÄÊúâÂçîË™øËÄÖÂ∞çÊáâÁöÑ skills
            const coordinatorSkills = new Set();
            data.categories.agents.items
                .filter(agent => agent.type === 'coordinator')
                .forEach(agent => {
                    // Âæû agent Ë∑ØÂæëÊèêÂèñÂ∞àÊ°àÂêçÁ®±Ôºà‰æãÂ¶ÇÂæû "DEV/.claude/agents/team001-xxx.md" ÊèêÂèñ "team001"Ôºâ
                    const pathParts = agent.path.split('/');
                    const fileName = agent.name;

                    // Ê™¢Êü•ÊòØÂê¶ÊúâÂ∞çÊáâÁöÑ skillÔºàÂêåÂêçÊàñÁõ∏ÂêåÂâçÁ∂¥Ôºâ
                    const matchingSkills = commands.filter(cmd =>
                        cmd.name === fileName ||
                        fileName.startsWith(cmd.name + '-') ||
                        cmd.name.startsWith(fileName.split('-')[0])
                    );
                    matchingSkills.forEach(cmd => coordinatorSkills.add(cmd.name));

                    // È°çÂ§ñÊ™¢Êü•Ôºöteam001, dopeman, dev-team-* Á≠âÂúòÈöäÂûã skills
                    if (agent.name.includes('team001')) coordinatorSkills.add('team001');
                    if (agent.name.includes('dopeman')) coordinatorSkills.add('dopeman');
                    if (agent.name.includes('team002')) coordinatorSkills.add('team002');
                });

            // ÊéíÂ∫èÔºöÂçîË™øËÄÖÁõ∏ÈóúÁöÑ skills ÂÑ™ÂÖà
            const sortedCommands = [...commands].sort((a, b) => {
                const aIsCoordinator = coordinatorSkills.has(a.name) ||
                    a.name.includes('team') ||
                    a.name === 'dopeman';
                const bIsCoordinator = coordinatorSkills.has(b.name) ||
                    b.name.includes('team') ||
                    b.name === 'dopeman';

                if (aIsCoordinator && !bIsCoordinator) return -1;
                if (!aIsCoordinator && bIsCoordinator) return 1;
                return a.name.localeCompare(b.name);
            });

            let html = '';

            sortedCommands.forEach(cmd => {
                const isCoordinator = coordinatorSkills.has(cmd.name) ||
                    cmd.name.includes('team') ||
                    cmd.name === 'dopeman';

                html += `<div class="tree-item">
                    <div class="tree-node">
                        ${isCoordinator ? '<span class="badge coordinator" style="margin-right: 8px;">ÂçîË™øËÄÖ</span>' : ''}
                        <span style="font-weight: 600; color: #667eea;">${cmd.full_command}</span>
                    </div>
                    <div class="tree-node tree-indent" style="color: #666;">
                        ${cmd.description}
                    </div>
                </div>`;
            });

            tree.innerHTML = html;
        }

        // Ê∏≤Êüì Dev Projects Âç°Áâá
        function renderDevProjectsTree() {
            const tree = document.getElementById('devProjectsTree');
            const projects = data.categories.dev_projects.items;

            if (projects.length === 0) {
                tree.innerHTML = '<div style="text-align: center; color: #999; padding: 40px;">Â∞öÁÑ°ÈñãÁôºÂ∞àÊ°à</div>';
                return;
            }

            let html = '';

            projects.forEach(project => {
                // Â∞àÊ°àÈ°ûÂûãÊ®ôÁ±§
                const typeClass = `project-type-${project.type}`;
                const typeLabel = {
                    'work': 'Â∑•‰ΩúÂ∞àÊ°à',
                    'own-dev': 'ÂÄã‰∫∫ÈñãÁôº',
                    'github-ref': 'GitHub ÂèÉËÄÉ',
                    'other': 'ÂÖ∂‰ªñ'
                }[project.type] || project.type;

                // ÊäÄË°ìÊ£ßÊ®ôÁ±§
                const techStackHtml = project.tech_stack.length > 0
                    ? project.tech_stack.map(tech => `<span class="tech-badge">${tech}</span>`).join('')
                    : '<span style="color: #999; font-size: 0.85em;">Êú™ÂÅµÊ∏¨Âà∞ÊäÄË°ìÊ£ß</span>';

                // Git ÁãÄÊÖã
                const gitStatus = project.is_dirty
                    ? '<span style="color: #f59e0b;">‚óè Êú™Êèê‰∫§</span>'
                    : '<span style="color: #10b981;">‚úì ‰πæÊ∑®</span>';

                // Claude Team ÁãÄÊÖã
                const claudeTeam = project.has_claude_team
                    ? '<span style="color: #667eea;">‚úì Claude Team</span>'
                    : '<span style="color: #999;">Ôºç</span>';

                // ÊúÄÂæå commit Ë≥áË®ä
                const lastCommit = project.last_commit_date
                    ? `${new Date(project.last_commit_date).toLocaleDateString('zh-TW')}`
                    : 'ÁÑ°';

                const commitMsg = project.last_commit_message
                    ? project.last_commit_message.substring(0, 60) + (project.last_commit_message.length > 60 ? '...' : '')
                    : '';

                html += `
                    <div class="project-card">
                        <div class="project-header">
                            <div class="project-name">üíª ${project.name}</div>
                            <div class="project-type-badge ${typeClass}">${typeLabel}</div>
                        </div>

                        <div class="project-meta">
                            <div class="project-meta-item">
                                <span>üìÅ</span>
                                <span>${project.path}</span>
                            </div>
                        </div>

                        <div class="tech-stack">
                            <span style="font-weight: 600; color: #666; font-size: 0.85em;">ÊäÄË°ìÊ£ß:</span>
                            ${techStackHtml}
                        </div>

                        <div class="project-meta">
                            <div class="project-meta-item">
                                <span>üîÄ Git:</span>
                                ${gitStatus}
                            </div>
                            <div class="project-meta-item">
                                <span>ü§ñ</span>
                                ${claudeTeam}
                            </div>
                            <div class="project-meta-item">
                                <span>üìÖ ÊúÄÂæåÊèê‰∫§:</span>
                                <span>${lastCommit}</span>
                            </div>
                        </div>

                        ${commitMsg ? `
                        <div style="font-size: 0.85em; color: #666; margin-top: 8px; font-style: italic;">
                            "${commitMsg}"
                        </div>
                        ` : ''}

                        <div class="project-actions">
                            <a href="${getEditorUrl(project.path)}" class="action-btn">
                                ${(() => {
                                    const defaultEditor = data.user_preferences?.default_editor || 'vscode';
                                    const tool = data.user_preferences?.editor_tools?.find(t => t.id === defaultEditor);
                                    return tool ? tool.icon : 'üìÇ';
                                })()} Open
                            </a>
                            ${project.remote_url && !project.remote_url.includes('D12CuS8TyU456') ? `
                            <a href="${project.remote_url}" target="_blank" class="action-btn action-btn-secondary">
                                üîó Git Remote
                            </a>
                            ` : ''}
                        </div>
                    </div>
                `;
            });

            tree.innerHTML = html;
        }

        // Ê∏≤ÊüìË®≠ÂÆöÈ†ÅÈù¢
        function renderSettings() {
            if (!data.user_preferences || !data.user_preferences.editor_tools) {
                return;
            }

            const container = document.getElementById('editorToolsContainer');
            const editorTools = data.user_preferences.editor_tools;
            const defaultEditor = data.user_preferences.default_editor || 'vscode';

            let html = '';

            editorTools.forEach(tool => {
                const checked = tool.id === defaultEditor ? 'checked' : '';
                const selected = tool.id === defaultEditor ? 'selected' : '';
                const enabledClass = tool.enabled ? 'enabled' : '';

                html += `
                    <div class="editor-tool-option ${selected}" onclick="selectEditor('${tool.id}')">
                        <input type="radio" name="defaultEditor" value="${tool.id}" ${checked} onclick="event.stopPropagation();">
                        <div class="editor-tool-icon">${tool.icon}</div>
                        <div class="editor-tool-info">
                            <div class="editor-tool-name">${tool.name}</div>
                            <div class="editor-tool-protocol">${tool.protocol}</div>
                        </div>
                        <div class="editor-tool-toggle" onclick="event.stopPropagation(); toggleEditorTool('${tool.id}')">
                            <div class="toggle-switch ${enabledClass}" id="toggle-${tool.id}"></div>
                            <span>${tool.enabled ? 'ÂïüÁî®' : 'ÂÅúÁî®'}</span>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        // ÈÅ∏ÊìáÈ†êË®≠Á∑®ËºØÂô®
        function selectEditor(toolId) {
            // Êõ¥Êñ∞Ë¶ñË¶∫ÁãÄÊÖã
            document.querySelectorAll('.editor-tool-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');

            // Êõ¥Êñ∞ radio ÈÅ∏Êìá
            const radio = event.currentTarget.querySelector('input[type="radio"]');
            if (radio) radio.checked = true;

            // Êõ¥Êñ∞Ë≥áÊñô
            data.user_preferences.default_editor = toolId;
        }

        // ÂàáÊèõÂ∑•ÂÖ∑ÂïüÁî®/ÂÅúÁî®
        function toggleEditorTool(toolId) {
            const tool = data.user_preferences.editor_tools.find(t => t.id === toolId);
            if (tool) {
                tool.enabled = !tool.enabled;
                renderSettings();
            }
        }

        // ÂÑ≤Â≠òË®≠ÂÆö
        async function saveSettings() {
            try {
                // È°ØÁ§∫ËºâÂÖ•‰∏≠
                const saveBtn = event.target;
                const statusSpan = document.getElementById('saveStatus');
                saveBtn.disabled = true;
                saveBtn.textContent = 'ÂÑ≤Â≠ò‰∏≠...';

                // Ê∫ñÂÇôË¶ÅÂÑ≤Â≠òÁöÑË≥áÊñô
                const preferencesData = {
                    version: "1.0.0",
                    last_updated: new Date().toISOString(),
                    preferences: data.user_preferences
                };

                // ‰ΩøÁî® Python ËÖ≥Êú¨ÂÑ≤Â≠òÔºàÂõ†ÁÇ∫ÁÄèË¶ΩÂô®ÁÑ°Ê≥ïÁõ¥Êé•ÂØ´Ê™îÊ°àÔºâ
                // ÂØ¶Èöõ‰∏äÈÄôË£°ÈúÄË¶Å‰∏ÄÂÄã API endpoint ‰æÜËôïÁêÜÂÑ≤Â≠ò
                // Êö´ÊôÇÂè™Êõ¥Êñ∞Êú¨Âú∞Ë≥áÊñôÂíåÈ°ØÁ§∫ÊàêÂäüË®äÊÅØ
                console.log('ÂÑ≤Â≠òË®≠ÂÆö:', preferencesData);

                // TODO: ÂØ¶‰ΩúÂØ¶ÈöõÁöÑÂÑ≤Â≠òÂäüËÉΩÔºàÈúÄË¶ÅÂæåÁ´Ø APIÔºâ
                // ÂèØËÉΩÁöÑËß£Ê±∫ÊñπÊ°àÔºö
                // 1. ‰ΩøÁî® Python HTTP server Êèê‰æõ POST endpoint
                // 2. ‰ΩøÁî® localStorage Êö´Â≠òÔºà‰ΩÜÈúÄË¶ÅÈáçÊñ∞ÊéÉÊèèÊôÇÂØ´ÂõûÊ™îÊ°àÔºâ

                // È°ØÁ§∫ÊàêÂäüË®äÊÅØ
                statusSpan.style.display = 'inline';
                saveBtn.textContent = 'üíæ ÂÑ≤Â≠òË®≠ÂÆö';
                saveBtn.disabled = false;

                setTimeout(() => {
                    statusSpan.style.display = 'none';
                }, 2000);

                alert('Ë®≠ÂÆöÂ∑≤Êõ¥Êñ∞ÔºÅ\\n\\nÊ≥®ÊÑèÔºöÁõÆÂâçË®≠ÂÆöÂÉÖÂú®Êú¨Ê¨° Dashboard ÊúÉË©±‰∏≠ÁîüÊïà„ÄÇ\\nËã•Ë¶ÅÊ∞∏‰πÖ‰øùÂ≠òÔºåË´ã‰øÆÊîπÔºö\\n~/.claude/memory/dopeman/user-preferences.json');
            } catch (error) {
                console.error('ÂÑ≤Â≠òË®≠ÂÆöÂ§±Êïó:', error);
                alert('ÂÑ≤Â≠òË®≠ÂÆöÂ§±ÊïóÔºÅË´ãÊ™¢Êü•ÊéßÂà∂Âè∞ÈåØË™§Ë®äÊÅØ„ÄÇ');
            }
        }

        // Êñ∞Â¢ûËá™Ë®ÇÂ∑•ÂÖ∑
        function addCustomTool() {
            const iconInput = document.getElementById('newToolIcon');
            const nameInput = document.getElementById('newToolName');
            const protocolInput = document.getElementById('newToolProtocol');

            const icon = iconInput.value.trim() || 'üîß';
            const name = nameInput.value.trim();
            const protocol = protocolInput.value.trim();

            if (!name || !protocol) {
                alert('Ë´ãÂ°´ÂØ´Â∑•ÂÖ∑ÂêçÁ®±ÂíåÈÄöË®äÂçîÂÆöÔºÅ');
                return;
            }

            // ÁîüÊàê ID
            const id = name.toLowerCase().replace(/\s+/g, '-');

            // Ê™¢Êü•ÊòØÂê¶Â∑≤Â≠òÂú®
            if (data.user_preferences.editor_tools.find(t => t.id === id)) {
                alert('Ê≠§Â∑•ÂÖ∑Â∑≤Â≠òÂú®ÔºÅË´ã‰ΩøÁî®‰∏çÂêåÁöÑÂêçÁ®±„ÄÇ');
                return;
            }

            // Êñ∞Â¢ûÂ∑•ÂÖ∑
            data.user_preferences.editor_tools.push({
                id: id,
                name: name,
                protocol: protocol,
                enabled: true,
                icon: icon
            });

            // Ê∏ÖÁ©∫Ëº∏ÂÖ•
            iconInput.value = '';
            nameInput.value = '';
            protocolInput.value = '';

            // ÈáçÊñ∞Ê∏≤Êüì
            renderSettings();

            alert(`Â∑•ÂÖ∑„Äå${name}„ÄçÂ∑≤Êñ∞Â¢ûÔºÅ\\nË®òÂæóÈªûÊìä„ÄåÂÑ≤Â≠òË®≠ÂÆö„Äç‰æÜ‰øùÂ≠òËÆäÊõ¥„ÄÇ`);
        }

        // ÂèñÂæóÁï∂ÂâçÈÅ∏ÊìáÁöÑÁ∑®ËºØÂô® URL
        function getEditorUrl(path) {
            if (!data.user_preferences || !data.user_preferences.editor_tools) {
                return `vscode://file${path}`;
            }

            const defaultEditor = data.user_preferences.default_editor || 'vscode';
            const tool = data.user_preferences.editor_tools.find(t => t.id === defaultEditor && t.enabled);

            if (!tool) {
                return `vscode://file${path}`;
            }

            return `${tool.protocol}${path}`;
        }

        // Ê∏≤ÊüìÂàÜÂ±§Ë¶ñÂúñ
        function renderLayersTree() {
            const tree = document.getElementById('layersTree');
            const layers = data.layers;

            let html = '';

            // Entry Layer
            html += `
                <div class="tree-item">
                    <div class="tree-node expandable expanded" onclick="toggleExpand(this)">
                        <span>üìç Entry Layer (ÂÖ•Âè£Â±§)</span>
                    </div>
                </div>
                <div class="tree-children">
                    <div class="tree-item tree-indent">
                        <div class="tree-node expandable expanded" onclick="toggleExpand(this)">
                            <span>‚å®Ô∏è Commands</span>
                            <span class="badge">${layers.entry.commands.length}</span>
                        </div>
                    </div>
                    <div class="tree-children">
            `;

            layers.entry.commands.forEach(cmd => {
                html += `
                    <div class="tree-item" style="margin-left: 48px;">
                        <div class="tree-node">
                            <span>${cmd}</span>
                        </div>
                    </div>
                `;
            });

            html += `
                    </div>
                </div>
            `;

            // Coordination Layer
            html += `
                <div class="tree-item" style="margin-top: 20px;">
                    <div class="tree-node expandable expanded" onclick="toggleExpand(this)">
                        <span>üìç Coordination Layer (ÂçîË™øÂ±§)</span>
                    </div>
                </div>
                <div class="tree-children">
                    <div class="tree-item tree-indent">
                        <div class="tree-node expandable expanded" onclick="toggleExpand(this)">
                            <span>üéØ Coordinators</span>
                            <span class="badge coordinator">${layers.coordination.coordinators.length}</span>
                        </div>
                    </div>
                    <div class="tree-children">
            `;

            layers.coordination.coordinators.forEach(coord => {
                html += `
                    <div class="tree-item" style="margin-left: 48px;">
                        <div class="tree-node">
                            <span class="status-dot status-coordinator"></span>
                            <span>${coord}</span>
                        </div>
                    </div>
                `;
            });

            html += `
                    </div>
                </div>
            `;

            // Execution Layer
            html += `
                <div class="tree-item" style="margin-top: 20px;">
                    <div class="tree-node expandable expanded" onclick="toggleExpand(this)">
                        <span>üìç Execution Layer (Âü∑Ë°åÂ±§)</span>
                    </div>
                </div>
                <div class="tree-children">
                    <div class="tree-item tree-indent">
                        <div class="tree-node expandable expanded" onclick="toggleExpand(this)">
                            <span>üë∑ Workers</span>
                            <span class="badge worker">${layers.execution.workers.length}</span>
                        </div>
                    </div>
                    <div class="tree-children">
            `;

            layers.execution.workers.forEach(worker => {
                html += `
                    <div class="tree-item" style="margin-left: 48px;">
                        <div class="tree-node">
                            <span class="status-dot status-worker"></span>
                            <span>${worker}</span>
                        </div>
                    </div>
                `;
            });

            html += `
                    </div>
                </div>
            `;

            tree.innerHTML = html;
        }

        // Ê∏≤ÊüìÈÅéÊøæÊåâÈàï
        function renderFilters() {
            const filters = document.getElementById('filterButtons');
            // Êö´ÊôÇÁïôÁ©∫Ôºå‰πãÂæåÂèØ‰ª•Âä†ÂÖ•ÈÅéÊøæÂäüËÉΩ
        }

        // ÂàáÊèõÂ±ïÈñã/Êë∫Áñä
        function toggleExpand(element) {
            element.classList.toggle('expanded');

            // ÊâæÂà∞‰∏ã‰∏ÄÂÄã tree-children ÂÆπÂô®
            let sibling = element.parentElement.nextElementSibling;

            // Â¶ÇÊûú‰∏ã‰∏ÄÂÄãÂÖÉÁ¥†ÊòØ tree-childrenÔºåÂàáÊèõÂÖ∂È°ØÁ§∫ÁãÄÊÖã
            if (sibling && sibling.classList.contains('tree-children')) {
                if (element.classList.contains('expanded')) {
                    sibling.style.display = 'block';
                } else {
                    sibling.style.display = 'none';
                }
            }
        }

        // ÂàáÊèõÂà∞ÊåáÂÆö Tab ÁöÑÂáΩÊï∏
        function switchToTab(tabId) {
            // ÁßªÈô§ÊâÄÊúâ active
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));

            // ÂïüÁî®ÁõÆÊ®ô tab
            const targetTab = document.querySelector(`.tab[data-tab="${tabId}"]`);
            if (targetTab) {
                targetTab.classList.add('active');
            }

            const targetContent = document.getElementById(tabId);
            if (targetContent) {
                targetContent.classList.add('active');
            }
        }

        // Ê®ôÁ±§È†ÅÂàáÊèõ
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.getAttribute('data-tab');
                switchToTab(tabId);
            });
        });

        // ÊêúÂ∞ãÂäüËÉΩ
        document.getElementById('searchInput').addEventListener('input', (e) => {
            const query = e.target.value.toLowerCase();
            // TODO: ÂØ¶‰ΩúÊêúÂ∞ãÈÅéÊøæ
        });

        // ÈáçÊñ∞ Scan ÂäüËÉΩ
        document.getElementById('rescanBtn').addEventListener('click', async () => {
            const btn = document.getElementById('rescanBtn');
            const btnText = btn.querySelector('.rescan-text');
            const btnIcon = btn.querySelector('.rescan-icon');

            // Ë®≠ÂÆöËºâÂÖ•‰∏≠ÁãÄÊÖã
            btn.classList.add('loading');
            btn.disabled = true;
            btnText.textContent = 'ÊéÉÊèè‰∏≠...';

            try {
                // Á¨¨‰∏ÄÊ≠•ÔºöÂëºÂè´ API Âü∑Ë°å Python ÊéÉÊèèËÖ≥Êú¨
                console.log('Ê≠£Âú®Âü∑Ë°å Python ÊéÉÊèèËÖ≥Êú¨...');
                const scanResponse = await fetch('/api/rescan', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    }
                });

                const scanResult = await scanResponse.json();

                if (!scanResult.success) {
                    throw new Error(scanResult.message || 'ÊéÉÊèèÂ§±Êïó');
                }

                console.log('Python ÊéÉÊèèÂÆåÊàêÔºÅ');

                // Á¨¨‰∫åÊ≠•ÔºöÈáçÊñ∞ËºâÂÖ•Êõ¥Êñ∞ÂæåÁöÑ JSON Ë≥áÊñô
                const timestamp = new Date().getTime();
                const response = await fetch(`./control-center-real-data.json?t=${timestamp}`);
                data = await response.json();
                filteredData = data;

                // ÈáçÊñ∞Ê∏≤ÊüìÊâÄÊúâÂÖßÂÆπ
                renderAll();

                // È°ØÁ§∫ÊàêÂäüË®äÊÅØ
                btnText.textContent = '‚úì ÂÆåÊàê';
                setTimeout(() => {
                    btnText.textContent = 'ÈáçÊñ∞ Scan';
                }, 2000);
            } catch (error) {
                console.error('ÈáçÊñ∞ÊéÉÊèèÂ§±Êïó:', error);
                btnText.textContent = '‚úó Â§±Êïó';
                alert(`ÈáçÊñ∞ÊéÉÊèèÂ§±ÊïóÔºö${error.message}\n\nË´ãÁ¢∫Ë™ç control-center-server.py Ê≠£Âú®ÈÅãË°å`);
                setTimeout(() => {
                    btnText.textContent = 'ÈáçÊñ∞ Scan';
                }, 2000);
            } finally {
                // ÁßªÈô§ËºâÂÖ•‰∏≠ÁãÄÊÖã
                btn.classList.remove('loading');
                btn.disabled = false;
            }
        });

        // ÂàùÂßãÂåñ
        loadData();
    </script>
</body>
</html>
